
@{
    ViewBag.title = "Relatorio";
}

<!DOCTYPE html>

<html>
<head>
    <script>
        window.onload = function () {

            var chart = new CanvasJS.Chart("Pareto", {
                title: {
                    text: "Erros durante execução de teste"
                },
                axisY: {
                    title: "Frequência",
                    lineColor: "#4F81BC",
                    tickColor: "#4F81BC",
                    labelFontColor: "#4F81BC"
                },
                axisY2: {
                    title: "Porcentagem",
                    suffix: "%",
                    lineColor: "#C0504E",
                    tickColor: "#C0504E",
                    labelFontColor: "#C0504E"
                },
                data: [{
                    type: "column",
                    dataPoints: [
                        { label: "Indeterminado", y: 30 },
                        { label: "Erros de lógica", y: 20 },
                        { label: "Html errors", y: 19 },
                        { label: "Conexão com o BD", y: 15 },
                        { label: "Erros de código", y: 10 },
                        { label: "Outros", y: 10 }
                    ]
                }]
            });
            chart.render();
            createPareto();

            function createPareto() {
                var dps = [];
                var yValue, yTotal = 0, yPercent = 0;

                for (var i = 0; i < chart.data[0].dataPoints.length; i++)
                    yTotal += chart.data[0].dataPoints[i].y;

                for (var i = 0; i < chart.data[0].dataPoints.length; i++) {
                    yValue = chart.data[0].dataPoints[i].y;
                    yPercent += (yValue / yTotal * 100);
                    dps.push({ label: chart.data[0].dataPoints[i].label, y: yPercent });
                }

                chart.addTo("data", { type: "line", yValueFormatString: "0.##\"%\"", dataPoints: dps });
                chart.data[1].set("axisYType", "secondary", false);
                chart.axisY[0].set("maximum", 50);
                chart.axisY2[0].set("maximum", 100);
            }

        }
    </script>
</head>
<body>
    <div id="Pareto" style="height: 700px; width: 100%;"></div>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
</body>
</html>
